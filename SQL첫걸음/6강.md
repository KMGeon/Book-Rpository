## 목차

---

## 25강 데이터베이스 객체

--- 

- 데이터베이스 객체는 자바에서 사용하는 객체와 다르다. 데이터베이스 내의 객체라는 의미는 디비에서 실체를 가지고 있는 어떤 것을 의미합니다. 

> 객체의 명명규칙
1. 기존 이름이나 예약어와 중복하지 않는다.
2. 숫자로 시작할 수 없다.
3. 언더스코어(_)를 사용할 수 없다.
4. 한글을 사용할 때는 더블쿼트로 둘러싼다.
5. 시스템이 허용하는 길이를 초과하지 않는다.

### 스키가

- 데이터베이스 객체는 스키마라는 그릇 안에 만들어진다. 
- 스키마는 sql 명령의 ddl을 이용하여 정의한다.

> 스키마나 테이블은 네임스페이스이기도 하다.

## 26강 테이블 작성, 삭제 변경
- 대표적인 데이터베이스 객체인 테이블을 작성, 삭제, 변경하는 방법에 대해 알아보자

```sql
# 생성
create table 테이블명(열 정의1, ...)

# 삭제
drop table 테이블명

# 삽입
alter table 테이블명 하부명령
```

> 테이블 작성
- ddl은 모두 같은 문법으로 사용한다. create , drop, alter로 작성, 삭제, 변경할 수 있다.
- 테이블을 작성한다면 create table, create view를 지정하면 도니다.

```sql
create table 테이블명(
    정의1,
    정의2,
    ...
)

열명 자료형 [ null | not null]
```

### 테이블 삭제
- 필요없는 테이블을 삭제할 수 있다. 

```sql
drop talbe 테이블명
```

- 테이터 행 삭제
  - drop talbe명령은 데이터베이스에서 테이블을 삭제한다.
  - 이때 삭제할 때 데이터도 같이 삭제하는데 만약에 테이블을 그대로 & 데이터 삭제를 원하면 다음과 같은 명령어를 사용하면 된다.

```sql
truncate table 테이블명
```

### 테이블 변경
- 테이블 변경을 위해서 alter table 명령을 통해 이루어진다.

```sql
alter table 테이블명 변경명령

# 열 추가
alter table 테이블명 add 열 정의

# 열 변경
alter table 테이블명 modify 열정의
```


## 27강 제약

---

- 열 이외에 제약을 정의할 수 있다. not null 제약이다.
- not null을 추가하면 데이터를 넣을 때 무조건 필수로 강제한다.

- 테이블을 생성하면 제약조건을 `constranint 키워드를 통해서 정의할 수 있다.`

```sql
create table sample632(
    no integer not null ,
    sub_no integer,
    primary key (no, sub_no)
);


create table sampele(
    no integer not null ,
    sub_no integer not null ,
    constraint pkey primary key (no,sub_no)
)
```


- 테이블의 제약은 나중에 삭제할 수 있다. 열 제약의 경우 제약을 추가할 때와 동일하게 열 정의를 변경한다.
```sql
-- 열 제약 없애기
alter table sample modify c varchar(30);

-- 테이블 제약 삭제하기
alter table sample drop constraint pkey
```


## 28강 인덱스

---

- 보통 책을 살펴보면 인덱스는 색인이라고 불린다. 
- 인덱스란 데이터를 정렬하여 저장하여 Read 검색속도를 향상을 시킨다.
- 여기서 검색이란 select 명령에 where구로 조건을 지정하고 그에 일치하는 행을 찾는 일련의 과정을 말한다.


### 검색에 사용하는 알고리즘
- 대표적인 검색 알고리즘으로는 이진 트리가 있다. 그 다음으로는 해시가 있다.

1. 풀 테이블 스캔
- 인덱스가 지정되지 않은 테이블을 검색할 때는 풀 테이블 스캔이라는 검색을 한다.
처리방법은 단순한데, 테이블에 저장된 모든 값을 처음부터 차례로 조사해나간다.

2. 이진 탐색
- 이진 탐색은 차례로 나열된 집합에 대해 유효한 검색 방법이다.
처음부터 순서대로 조사하는 것이 아니라 집합의 반으로 나누어 조사하는 방법


<br/>

## 29강 인덱스 작성과 삭제

--- 

- 인덱스 작성, 삭제
```sql
create index 인덱스명 on 테이블명 (열명)

-- 스키마 객체의 경우
drop index 인덱스명
  
-- 테이블 내 객체의 경우
drop index 인덱스명 on 테이블명
```

## 30강 뷰 작성과 삭제

---

- 뷰는 테이블과 같은 부류의 데이터베이스 객체 중 하나이다.

```sql
create view 뷰명 as select 명령
drop view 뷰명
```
> 뷰란 무엇인가?

- 본래 데이터베이스 객체로 등록할 수 없는 select 명령을 객체로서 이름을 붙여 관리할 수 있도록 한 것이 뷰.
- select 명령은 실행했을 때 테이블에 저장된 데이터를 결과값으로 반환합니다.

```sql
create view sample_view_67 as select * from sample54;

explain select * from sample_view_67;
```

> 뷰는 테이블처럼 취급할 수 있지만 `실제로 존재하지 않는다`라는 의미로 가상 테이블이라 불리기도 한다.
> select 명령으로 이루어지는 뷰는 테이블처럼 데이터를 쓰거나 지울 수 있는 저장공간을 가지지 않습니다.
> 일반적으로 select 명령에서만 사용하는 것을 권장한다고 한다. wirte작업에서도 조건이 맞으면 가능하지만 사용에 주의할 필요가 있다고 말한다.

- 뷰 삭제
뷰를 삭제할 경우에는 drop view를 사용한다. 일단 뷰를 삭제하면 더 이상 뷰를 참조하여 사용할 수 없습니다.

```sql
drop view sample_view_67
```

### 뷰의 약점

- 뷰는 데이터에비스 객체로서 저장장치에 위치를 한다. 하지만 테이블과 달리 대량의 저장공간을 필요로 하지 않습니다.

- 뷰는 저장공간을 소비하지 않는 대신 cpu 자원을 사용한다. 즉. 많은 데이터 또는 정렬에 대한 쿼리를 수행하면 cpu에 부화를 주어 성능에 문제가 생길 수 잇습니다.

### 머티리얼라이즈드 뷰

- 뷰의 근원이 되는 테이블에 보관하는 데이터양이 많은 경우 집계처리를 할 때도 뷰가 사용된다면 처리 속도가 많이 떨어진다.
뷰를 중첩해서 사용하는 경우에도 처리 속도가 떨어지기 쉽다.

- 이러한 문제를 해결하기 위해 머티리얼라이즈드 뷰를 사용한다. 
일반적으로 뷰는 데이터를 일시적으로 저장했다가 쿼리가 종료될 때 함께 삭제한다. 그에 비해 머티리얼라이즈드 뷰는 데이터를 일시적으로 저장해 사용하는 것이 아니라 테이블 처럼 저장하고 사용한다.

- 머티리얼라이즈드 처음 참조되었을 때 데이터를 저장하고 이후 다시 참조할 때 그대로 사용한다.
-> 일반적인 뷰처럼 매번 select명령을 실행할 필요가 없다. 다만 뷰에 지정된 테이블의 데이터가 변경된 경우에는 select 명령을 재시작한다.

> 이처럼 변경 유무를 확인하여 재실행하는 것을 rdbms가 자동으로 실행하지만 mysql에서는 머티리얼라이즈드 뷰를 사용할 수 없어 단점을 가진다.

### 함수 테이블

- 뷰를 구성하는 select명령은 단독으로 실행할 수 있어야 한다. 부모 쿼리와 어떤 식으로든 연관된 서브쿼리의 경우 사용할 수 없다.
- 대신 이 약점을 해결하기 위해 함수 테이블을 사용할 수 있다.

